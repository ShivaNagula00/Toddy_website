<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mobile Map Test - Toddy Shop</title>
<style>
.container{max-width:500px;margin:20px auto;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
.map-container{margin:20px 0;border:1px solid #ddd;border-radius:8px;overflow:hidden}
#shopMap{height:300px;width:100%;background:#f5f5f5;display:flex;align-items:center;justify-content:center}
.fallback-content{text-align:center;padding:40px 20px;color:#666}
.map-button{background:#4285f4;color:white;padding:12px 24px;text-decoration:none;border-radius:6px;display:inline-block;font-weight:bold;margin:10px}
@media (max-width:768px){
    .container{margin:10px;padding:15px}
    #shopMap{height:250px}
    .map-button{display:block;margin:10px 0}
}
</style>
</head>
<body>
<div class="container">
    <h1>Mobile Map Test</h1>
    <p>Testing map display for pickup orders on mobile devices.</p>
    
    <div class="map-container">
        <div id="shopMap">
            <div class="fallback-content">
                <p>Loading map...</p>
            </div>
        </div>
    </div>
    
    <div style="text-align:center;margin-top:20px">
        <a href="https://www.google.com/maps?q=18.64110,78.87335" target="_blank" class="map-button">
            üó∫Ô∏è Open in Google Maps
        </a>
        <a href="tel:+916302564464" class="map-button" style="background:#28a745">
            üìû Call Shop
        </a>
    </div>
</div>

<script>
// Test the same logic used in order-success.html
function initializeMap() {
    const shopLat = 18.64110;
    const shopLng = 78.87335;
    
    // Check if Google Maps API is loaded
    const checkGoogleMaps = () => {
        if (typeof google !== 'undefined' && google.maps) {
            // Google Maps is available - initialize map
            console.log('Google Maps API detected - initializing map');
            
            const mapOptions = {
                zoom: 15,
                center: { lat: shopLat, lng: shopLng },
                // Mobile-friendly options
                gestureHandling: 'cooperative',
                zoomControl: true,
                mapTypeControl: false,
                scaleControl: false,
                streetViewControl: false,
                rotateControl: false,
                fullscreenControl: true
            };
            
            const shopMap = new google.maps.Map(document.getElementById('shopMap'), mapOptions);
            
            new google.maps.Marker({
                position: { lat: shopLat, lng: shopLng },
                map: shopMap,
                title: 'Toddy Shop - Pickup Location',
                icon: 'https://maps.google.com/mapfiles/ms/icons/red-dot.png'
            });
            
            // Add click listener to open in Google Maps app on mobile
            shopMap.addListener('click', () => {
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                if (isMobile) {
                    window.open(`https://www.google.com/maps?q=${shopLat},${shopLng}`, '_blank');
                }
            });
        } else {
            // Google Maps not available - show fallback
            console.log('Google Maps API not available - showing fallback');
            
            document.getElementById('shopMap').innerHTML = `
                <div class="fallback-content">
                    <h3 style="color:#28a745;margin-bottom:15px">üìç Shop Location</h3>
                    <p style="margin-bottom:15px">JVRF+996 Kallu manduva kodimial<br>Sandralapally X Rd, Sandralapally<br>Telangana 505501</p>
                    <p style="color:#666;font-size:14px">Map not available. Use the buttons below to navigate.</p>
                </div>
            `;
        }
    };
    
    // Check immediately and after delays for API loading
    checkGoogleMaps();
    setTimeout(checkGoogleMaps, 1000);
    setTimeout(checkGoogleMaps, 3000);
}

// Initialize when page loads
window.addEventListener('load', initializeMap);

// Also check device type
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
console.log('Device type:', isMobile ? 'Mobile' : 'Desktop');
</script>

<!-- Uncomment this line to test with Google Maps API -->
<!-- <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places" async defer></script> -->

</body>
</html>